// FileIO v1.4.2c Lite (Jun.13.2007)
if(document.implementation.hasFeature("XPath","3.0")){XMLDocument.prototype.selectNodes=function(_1,_2){if(!_2){_2=this;}var _3=this.createNSResolver(this.documentElement);var _4=this.evaluate(_1,_2,_3,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var _5=[];for(var i=0;i<_4.snapshotLength;i++){_5[i]=_4.snapshotItem(i);}return _5;};Element.prototype.selectNodes=function(_7){if(this.ownerDocument.selectNodes){return this.ownerDocument.selectNodes(_7,this);}else{return false;}};XMLDocument.prototype.selectSingleNode=function(_8,_9){if(!_9){_9=this;}var _a=this.selectNodes(_8,_9);if(_a.length>0){return _a[0];}else{return false;}};Element.prototype.selectSingleNode=function(_b){if(this.ownerDocument.selectSingleNode){return this.ownerDocument.selectSingleNode(_b,this);}else{return false;}};}if(/^undefined$/i.test(typeof window.console)){var consoleFactory=function(_c){if(_c=="time"){return function(){window["console"].timers[arguments[0]]=new Date().getTime();};}else{if(_c=="timeEnd"){return function(){var _d=["&nbsp;"];_d.push(arguments[0]+": "+(new Date().getTime()-window["console"].timers[arguments[0]])+"ms");window.console._log("time",_d.join(""));};}else{return function(){var _e=["&nbsp;"];if(!_c.match(/^(profile|profileEnd)$/)){for(var i=0;i<arguments.length;i++){_e.push(arguments[i].toString()+" ");}window.console._log(_c,_e.join(""));}};}}};window.console=new function(){this.log=new consoleFactory("log");this.info=new consoleFactory("info");this.warn=new consoleFactory("warn");this.error=new consoleFactory("error");this.time=new consoleFactory("time");this.timeEnd=new consoleFactory("timeEnd");this.profile=new consoleFactory("profile");this.profileEnd=new consoleFactory("profileEnd");this.firebug=false;};}else{window.console.firebug=true;}if(/^undefined$/i.test(typeof window.console.console)){var newConsoleFactory=function(_10){return function(){if(this.DEBUG){this.init();for(var i=0;i<arguments.length;i++){if(document.all&&/^object$/i.test(typeof arguments[i])&&/^string$/i.test(typeof arguments[i].name)&&/^string$/i.test(typeof arguments[i].message)){arguments[i]=arguments["+i+"].name+": "+arguments["+i+"].message;}}this.console[_10].apply(this.console,arguments);}};};var _oldConsole=window.console;window.console=new function(){this.console=_oldConsole;this.DEBUG=false;this.timers={};this.init=function(){if(!this.console.firebug&&!document.getElementById("debug_console")){var con=document.createElement("DIV");document.body.appendChild(con);var _13=document.createElement("DIV");con.appendChild(_13);_13.margin="0px";_13.padding="0px";con.id="debug_console";con.collapsed=false;con.style.zIndex=1000000;con.style.position="absolute";con.style.top="0px";con.style.left="0px";con.style.width="100%";con.style.margin="0px";con.style.padding="0px";con.style.borderBottom="1px solid #999";con.style.backgroundColor="#F6F6F6";con.style.height="200px";con.style.overflow="auto";con.style.cursor="pointer";if(document.all){con.style.left=document.body.currentStyle.marginLeft;if(!/^0/.test(con.style.left)){con.style.borderLeft=con.style.borderBottom;con.style.borderRight=con.style.borderBottom;}}con.onclick=function(){var _14=this.getElementsByTagName("div")[0];if(this.collapsed){this.style.height="200px";this.style.backgroundColor="#F6F6F6";this.style.overflow="auto";_14.style.display="block";}else{this.style.height="4px";this.style.backgroundColor="#C6C6C6";this.style.overflow="hidden";_14.style.display="none";}this.collapsed=!this.collapsed;};}};this.log=new newConsoleFactory("log");this.info=new newConsoleFactory("info");this.warn=new newConsoleFactory("warn");this.error=new newConsoleFactory("error");this.time=new newConsoleFactory("time");this.timeEnd=new newConsoleFactory("timeEnd");this.profile=new newConsoleFactory("profile");this.profileEnd=new newConsoleFactory("profileEnd");};window.console._log=function(_15,_16){var con=document.getElementById("debug_console");var _18=con.getElementsByTagName("div")[0];var _19=document.createElement("DIV");_19.innerHTML="<span style=\"display: block; float: left; width: 5em; font-weight: bold;\">"+_15.toUpperCase()+"&nbsp;&nbsp&nbsp;</span>"+_16;_19.style.margin="0px";_19.style.padding="2px 5px";_19.style.borderBottom="1px solid #D6D6D6";if(/^log$/i.test(_15)){_19.style.color="#000";}else{if(/^info$/i.test(_15)){_19.style.color="#00F";}else{if(/^warn$/i.test(_15)){_19.style.backgroundColor="#FF9";}else{if(/^error$/i.test(_15)){_19.style.backgroundColor="#F99";}}}}_18.appendChild(_19);if(con.collapsed){con.style.height="200px";con.style.backgroundColor="#F6F6F6";con.style.overflow="auto";_18.style.display="block";}};}var FileIO={IS_WINDOWS:/win/i.test(navigator.userAgent.toLowerCase()),IS_HTA:document.all?(function(){var _1a=window;while(_1a.frameElement!=null){_1a=_1a.parent;}return /\.hta$/i.test(_1a.location);})():false,HAS_ADODB:document.all?(function(){try{var _1b=new ActiveXObject("ADODB.Stream");return true;}catch(e){return false;}})():false,EXITCODE_ERROR:-2147483648,EXITCODE_RESET:2147483647,WRAPPER_PATH:(function(){var _1c=document.getElementsByTagName("SCRIPT");
for(var i=0;i<_1c.length;i++){if(/fileio[^\\\/]*?\.js$/i.test(_1c[i].src)){if(document.all){return _1c[i].src.replace(/(fileio)[^\\\/]*?\.js$/i,"$1.exe");}else{var url=window.location.toString();return _1c[i].src.replace(url.substr(0,url.lastIndexOf("/")+1),"").replace(/(fileio)[^\\\/]*?\.js$/i,"$1.exe");}}}})(),ENABLE_MOZILLA_EXECUTE_ASYNC:false,AJAX_POLL_RATE:50,AJAX_POLL_TIMEOUT:20000,_poll:{},loadRemoteXML:function(url,_20){var xml=false;_20=/^function$/i.test(typeof _20)?_20:false;if(window.ActiveXObject){try{var xml=false;try{xml=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{xml=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){console.warn(e);return false;}}if(xml){xml.open("GET",url,_20?true:false);if(_20){var _25=function(){if(xml.readyState==4){window.clearInterval(FileIO._poll[url]);delete FileIO._poll[url];var _26=(xml.status==200||xml.status==304||xml.status==0)?FileIO.makeDOMDocument(xml.responseText):false;_20.call(_26,_26);xml=null;_20=null;}};FileIO._poll[url]=setInterval(_25,FileIO.AJAX_POLL_RATE);setTimeout(function(){try{window.clearInterval(FileIO._poll[url]);
xml=null;_20=null;}catch(e){}},FileIO.AJAX_POLL_TIMEOUT);xml.send("");return true;}else{xml.send("");return (xml.status==200||xml.status==304||xml.status==0)?FileIO.makeDOMDocument(xml.responseText):false;}}else{return false;}}catch(e){return false;}}return xml;},loadXML:function(_27){var xml=false;if(window.ActiveXObject){_27=FileIO.normalizePath(_27);try{xml=FileIO.getDOMDocument();xml.load(_27);try{xml.setProperty("SelectionLanguage","XPath");xml.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");}catch(e){return false;}return xml;}catch(e){console.warn(e);return false;}}return xml;},saveXML:function(_29,_2a){if(document.all){try{_2a.save(FileIO.normalizePath(_29));return true;}catch(e){}}return FileIO.saveFile(_29,FileIO.makeDOMString(_2a));},loadRemoteFile:function(url,_2c){var xml=false;_2c=/^function$/i.test(typeof _2c)?_2c:false;if(window.ActiveXObject){try{var xml=false;try{xml=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{xml=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){return false;}}if(xml){xml.open("GET",url,_2c?true:false);if(_2c){var _31=function(){if(xml.readyState==4){window.clearInterval(FileIO._poll[url]);delete FileIO._poll[url];var _32=(xml.status==200||xml.status==304||xml.status==0)?xml.responseText:false;_2c.call(_32,_32);xml=null;_2c=null;}};FileIO._poll[url]=setInterval(_31,FileIO.AJAX_POLL_RATE);setTimeout(function(){try{window.clearInterval(FileIO._poll[url]);xml=null;_2c=null;}catch(e){}},FileIO.AJAX_POLL_TIMEOUT);xml.send("");return true;}else{xml.send("");return (xml.status==200||xml.status==304||xml.status==0)?xml.responseText:false;}}else{return false;}}catch(e){return false;}}return xml;},loadFile:function(_33){_33=FileIO.normalizePath(_33,true);var doc=false;if(window.ActiveXObject){try{doc=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{doc=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){console.warn(e);return false;}}}if(doc){try{doc.open("GET",_33,false);doc.send(null);}catch(e){console.warn(e);return false;}if(doc.responseText){return doc.responseText;}else{if(doc.responseXML){return FileIO.makeDOMString(doc.responseXML);}else{return false;}}}else{return false;}},saveFile:function(_35,_36,_37){_37=_37||false;_35=FileIO.normalizePath(_35);if(window.ActiveXObject){try{try{var _38=new ActiveXObject("ADODB.Stream");_38.Open();_38.Type=2;_38.Charset="utf-8";_38.WriteText(_36);_38.SaveToFile(_35,2);_38.Close();}catch(e){var fso=new ActiveXObject("Scripting.FileSystemObject");var _3a=fso.CreateTextFile(_35,true);for(var i=_36.length-1;i>=0;i--){var _3c=_36.charCodeAt(i);if(_3c>128){_3c=_3c.toString(16);while(_3c.length<4){_3c="0"+_3c;}_36=_36.substr(0,i)+"\\u"+_3c+_36.substr(i+1);}}_3a.Write(_36);_3a.Close();}return true;}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _3d=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);_3d.initWithPath(_35);if(!_3d.exists()){_3d.create(0,_37?493:420);}var _3e=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);_3e.init(_3d,32|4,4,null);var _3f=Components.classes["@mozilla.org/intl/converter-output-stream;1"].createInstance(Components.interfaces.nsIConverterOutputStream);_3f.init(_3e,"UTF-8",0,0);_3f.writeString(_36);_3f.close();_3e.close();return true;}catch(e){console.warn(e);return false;}}else{return false;}}},deleteFile:function(_40){_40=FileIO.normalizePath(_40);if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");if(fso.FileExists(_40)){fso.DeleteFile(_40,true);}return true;}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _42=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
_42.initWithPath(_40);if(_42.exists()){_42.remove(false);}return true;}catch(e){console.warn(e);return false;}}else{return false;}}},createDirectory:function(_43){_43=FileIO.normalizePath(_43);if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");if(!fso.FolderExists(_43)){fso.CreateFolder(_43);}return true;}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _45=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);_45.initWithPath(_43);if(!_45.exists()){_45.create(1,493);}return true;}catch(e){console.warn(e);return false;}}else{return false;}}},deleteDirectory:function(_46){_46=FileIO.normalizePath(_46);if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");if(fso.FolderExists(_46)){fso.DeleteFolder(_46,true);}return true;}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _48=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);_48.initWithPath(_46);if(_48.exists()){_48.remove(true);}return true;}catch(e){console.warn(e);return false;}}else{return false;}}},listDirectory:function(_49){_49=FileIO.normalizePath(_49);var _4a={path:_49,files:new Array(),folders:new Array()};if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");var dir=false;try{dir=fso.GetFolder(_4a.path);}catch(e){try{_4a.path=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1).replace("file:///","")+_4a.path.replace(/\\/g,"/");dir=fso.GetFolder(_4a.path);}catch(e){console.warn(e);}}if(dir){var _4d=new Enumerator(dir.files);while(!_4d.atEnd()){_4a.files.push(_4d.item().Name);_4d.moveNext();}var _4e=new Enumerator(dir.subFolders);while(!_4e.atEnd()){_4a.folders.push(_4e.item().Name);_4e.moveNext();}_4a.folders.sort();_4a.files.sort();return _4a;}else{return false;}}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var dir=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);try{dir.initWithPath(_4a.path);}catch(e){try{_4a.path=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1).replace("file:///","")+_4a.path.replace(/\\/g,"/");_4a.path=_4a.path.replace(/\//g,"\\");dir.initWithPath(_4a.path);}catch(e){console.warn(e);}}var _50=dir.directoryEntries;while(_50.hasMoreElements()){var _51=_50.getNext();_51.QueryInterface(Components.interfaces.nsIFile);if(_51.isDirectory()){_4a.folders.push(_51.leafName);}else{_4a.files.push(_51.leafName);}}_4a.folders.sort();_4a.files.sort();return _4a;}catch(e){console.warn(e);return false;}}else{return false;}}},transformXML:function(xml,xsl,_54){_54=_54||false;var t=false;if(window.ActiveXObject){if(_54){try{var _56=new ActiveXObject("Msxml2.XSLTemplate");var _57=new ActiveXObject("Msxml2.FreeThreadedDOMDocument");_57.async=false;_57.loadXML(FileIO.makeDOMString(xsl));_56.stylesheet=_57;var _58=_56.createProcessor();_58.input=xml;for(var key in _54){_58.addParameter(key,_54[key]);}_58.transform();t=_58.output;t=t.replace(/^\<\?.+?utf-16.*?\?\>/i,"");}catch(e){console.warn(e);return false;}}else{t=xml.transformNode(xsl);}}return t;},validateXML:function(_5e,_5f){_5e=FileIO.normalizePath(_5e);_5f=FileIO.normalizePath(_5f);if(document.all){try{var _60=FileIO.loadXML(_5f);var _61=new ActiveXObject("Msxml2.XMLSchemaCache.4.0");_61.add("",_60);xml=FileIO.getDOMDocument();xml.validateOnParse=true;xml.schemas=_61;if(xml.load(_5e)){return true;}else{return false;}}catch(e){console.warn(e);return false;}}else{try{return true;}catch(e){console.warn(e);return false;}}return false;},getDOMDocument:function(){var doc=false;if(document.implementation&&document.implementation.createDocument){doc=document.implementation.createDocument("","",null);}else{if(window.ActiveXObject){try{doc=new ActiveXObject("Msxml2.DOMDocument.4.0");}catch(e){try{doc=new ActiveXObject("Microsoft.XMLDOM");}catch(e){console.warn(e);}}try{doc.async=false;doc.setProperty("SelectionLanguage","XPath");doc.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");}catch(e){console.warn(e);}}}return doc;},makeDOMDocument:function(_63){var doc=false;if(document.implementation&&document.implementation.createDocument){var _65=new DOMParser();doc=_65.parseFromString(_63,"text/xml");}else{if(window.ActiveXObject){try{doc=new ActiveXObject("Msxml2.DOMDocument.4.0");}catch(e){try{doc=new ActiveXObject("Microsoft.XMLDOM");}catch(e){console.warn(e);}}if(doc){doc.async=false;doc.validateOnParse=false;doc.loadXML(_63);try{doc.setProperty("SelectionLanguage","XPath");doc.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");}catch(e){console.warn(e);}}}}return doc;},makeDOMString:function(_66){if(document.implementation&&document.implementation.createDocument){var _67=new XMLSerializer();
return _67.serializeToString(_66);}else{if(window.ActiveXObject){return _66.xml.substr(0,_66.xml.length-2);}}return false;},execute:function(_68,_69,_6a,_6b,_6c,_6d){_69=_69||null;_6a=/^undefined$/i.test(typeof _6a)?true:_6a;_6b=/^undefined$/i.test(typeof _6b)?true:_6b;_6c=_6c||false;_6d=_6d||false;if(_6b){_68=FileIO.normalizePath(_68);if(!FileIO.Properties.isFile(_68)){return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}}var _6e=FileIO.normalizePath(FileIO.WRAPPER_PATH);var _6f=false;if(_69!=null){for(var i=0;i<_69.length;i++){if(!/^".*?"$/.test(_69[i])){_69[i]="\""+_69[i]+"\"";}}}if(document.all){try{var _71=new ActiveXObject("WScript.shell");}catch(e){console.warn(e);return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}var cmd="\""+_6e;if(_6d){cmd+="\" -s \"";}else{cmd+="\" \"";}cmd+=_68+"\"";if(_69!=null){for(var i=0;i<_69.length;i++){cmd+=" "+_69[i];}}try{var _74=FileIO.normalizePath(".");_71.CurrentDirectory=_74.substr(0,_74.length-1);if(_6a){_6f=_71.Run(cmd,0,_6a);}else{_6f=_71.Exec(cmd);}}catch(e){console.warn(e);return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}}else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _75=new Components.Constructor("@mozilla.org/file/local;1","nsILocalFile","initWithPath");try{var _76=new _75(_6e);}catch(e){console.warn(e);return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}try{_6f=Components.classes["@mozilla.org/process/util;1"].createInstance(Components.interfaces.nsIProcess);}catch(e){console.warn(e);return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}try{if(!_6a&&FileIO.ENABLE_MOZILLA_EXECUTE_ASYNC){try{var _77="";if(!FileIO.IS_WINDOWS){_77+="#!/bin/bash\n";}else{_77+="@echo off\n";}_77+="exit "+FileIO.EXITCODE_RESET+"\n";var _78="reset_mozilla_exitcode_"+new Date().getTime()+(FileIO.IS_WINDOWS?".bat":".sh");FileIO.saveFile(_78,_77,true);_6f.init(new _75(FileIO.normalizePath(_78)));_6f.run(true,null,0,{});FileIO.deleteFile(_78);}catch(e){console.warn(e);return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}}var _79=new Array();if(!FileIO.IS_WINDOWS){_79.push("#!/bin/bash\n");}else{_79.push("@echo off\n");}if(_68.indexOf(FileIO.IS_WINDOWS?"\\":"/")>-1){_79.push("cd "+(FileIO.IS_WINDOWS?"/D ":"")+"\"");_79.push(FileIO.IS_WINDOWS?_68.substr(0,_68.lastIndexOf("\\")):_68.substr(0,_68.lastIndexOf("/")));_79.push("\"\n");}var _7a=function(_7b,_7c){_7b=/errorlevel/i.test(_7b)?FileIO.IS_WINDOWS?"ERRORLEVEL":"?":_7b;return (FileIO.IS_WINDOWS?"set "+_7b+"=":"export "+_7b+"=")+_7c+"\n";};var _7d=function(_7e){_7e=/errorlevel/i.test(_7e)?FileIO.IS_WINDOWS?"ERRORLEVEL":"?":_7e;return FileIO.IS_WINDOWS?"%"+_7e+"%":"$"+_7e;};var _7f="\""+(FileIO.IS_WINDOWS?_68.substr(_68.lastIndexOf("\\")+1):_68.substr(_68.lastIndexOf("/")+1))+"\"";_79.push(_7a("FILEIO_EXE",_7f));if(_69!=null){for(var i=0;i<_69.length;i++){_79.push(_7a("FILEIO_ARG"+i,_69[i]));}}_79.push(FileIO.IS_WINDOWS?"call ":"source ");_79.push(_7d("FILEIO_EXE"));if(_69!=null){for(var i=0;i<_69.length;i++){_79.push(" "+_7d("FILEIO_ARG"+i));}}_79.push("\n");_79.push("exit "+_7d("ERRORLEVEL")+"\n");_79=_79.join("");var _82="fileio_runner_"+new Date().getTime()+(FileIO.IS_WINDOWS?".bat":".sh");FileIO.saveFile(_82,_79,true);_6f.init(_76);var _83=[FileIO.normalizePath(_82)];_6f.run(FileIO.ENABLE_MOZILLA_EXECUTE_ASYNC?_6a:true,_83,_83.length,{});FileIO.deleteFile(_82);}catch(e){console.warn(e);return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}}if(_6a){return {exitCode:document.all?_6f:_6f.exitValue,failure:(document.all?_6f:_6f.exitValue)!=0};}else{if(!_6a&&/object/i.test(typeof _6c)&&/number/i.test(typeof _6c.poll)&&/number/i.test(typeof _6c.timeout)&&/function/i.test(typeof _6c.exitHandler)&&/function/i.test(typeof _6c.timeoutHandler)){var _84=new function(){this.async=_6c;this.hash=_68+"?args="+(_69!=null?_69.toString():"")+"&hash="+new Date().getTime();this.process=_6f;this.poll=function(){if(document.all){if(this.process.Status==1){this.kill=function(){};if(this.pollID){clearInterval(this.pollID);}if(this.killID){clearTimeout(this.killID);}this.async.exitHandler({exitCode:this.process.ExitCode,failure:this.process.ExitCode!=0,hash:this.hash});setTimeout(_84.destroy,50);return true;}else{return false;}}else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");if(this.process.exitValue!=FileIO.EXITCODE_RESET){this.kill=function(){};if(this.pollID){clearInterval(this.pollID);}if(this.killID){clearTimeout(this.killID);}this.async.exitHandler({exitCode:this.process.exitValue,failure:this.process.exitValue!=0,hash:this.hash});setTimeout(_84.destroy,50);return true;}else{return false;}}};this.kill=function(){try{this.poll=function(){};if(this.pollID){clearInterval(this.pollID);}if(this.killID){clearTimeout(this.killID);}if(document.all){this.process.Terminate();}else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");this.process.kill();}this.async.timeoutHandler({exitCode:FileIO.EXITCODE_ERROR,failure:true,hash:this.hash});setTimeout(_84.destroy,50);return true;}catch(e){if(this.pollID){clearInterval(this.pollID);}if(this.killID){clearTimeout(this.killID);}setTimeout(_84.destroy,50);return false;}};this.pollID=false;this.killID=false;this.pollBind=function(){_84.poll.call(_84);};this.killBind=function(){_84.kill.call(_84);};this.destroy=function(){_84.poll=null;_84.kill=null;_84.pollBind=null;_84.killBind=null;_84=null;};};if(document.all||FileIO.ENABLE_MOZILLA_EXECUTE_ASYNC){_84.pollID=setInterval(_84.pollBind,_84.async.poll);
_84.killID=setTimeout(_84.killBind,_84.async.timeout);}else{setTimeout(function(){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");_84.async.exitHandler({exitCode:_84.process.exitValue,failure:_84.process.exitValue!=0,hash:_84.hash});},50);setTimeout(_84.destroy,100);}return {failure:false,hash:_84.hash,kill:function(){try{_84.kill();return true;}catch(e){console.warn(e);return false;}}};}else{return {exitCode:FileIO.EXITCODE_ERROR,failure:true};}}},textContent:function(_85){return typeof _85.textContent=="string"?_85.textContent:_85.text;},normalizePath:function(_86,url){_86=_86.replace(/^file:\/\/\//,"").replace(/^file:/,"").replace(/\\/g,"/");if(_86.length==0){return false;}var _88=window.location.href.replace(/^file:\/\/\//,"").replace(/^file:/,"");if(_88.indexOf("/")>-1){_88=_88.substr(0,_88.lastIndexOf("/")+1)+_86.replace(/\\/g,"/");}if(!/^\//.test(_86)&&!/^[a-z]:/i.test(_86)){_86=_88;}_86=_86.replace(/\/([^\/]+?)\/\.\//g,"/$1/");_86=_86.replace(/\/([^\/]+?)\/\.\.\//g,"/");if(FileIO.IS_WINDOWS&&!url){_86=_86.replace(/\//g,"\\");}_86=_86.replace(/%20/g," ");if(url&&FileIO.IS_WINDOWS){_86="file:///"+_86;}else{if(url&&!FileIO.IS_WINDOWS){_86="file:"+_86;}}return _86;}};FileIO.Properties={lastModified:function(_89){_89=FileIO.normalizePath(_89);if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");var _8b=false;try{_8b=fso.GetFile(_89);}catch(e){try{_89=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1).replace("file:///","")+_89.replace(/\\/g,"/");_8b=fso.GetFile(_89);}catch(e){console.warn(e);}}if(_8b){return _8b.DateLastModified;}else{return false;}}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _8c=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);try{_8c.initWithPath(_89);}catch(e){try{_89=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1).replace("file:///","")+_89.replace(/\\/g,"/");_89=_89.replace(/\//g,"\\");_8c.initWithPath(_89);}catch(e){console.warn(e);}}return _8c.lastModifiedTime;}catch(e){console.warn(e);return false;}}else{return false;}}},size:function(_8d){_8d=FileIO.normalizePath(_8d);if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");var _8f=false;try{_8f=fso.GetFile(_8d);}catch(e){try{_8d=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1).replace("file:///","")+_8d.replace(/\\/g,"/");_8f=fso.GetFile(_8d);}catch(e){console.warn(e);}}if(_8f){return _8f.Size;}else{return false;}}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _90=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);try{_90.initWithPath(_8d);}catch(e){try{_8d=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1).replace("file:///","")+_8d.replace(/\\/g,"/");_8d=_8d.replace(/\//g,"\\");_90.initWithPath(_8d);}catch(e){console.warn(e);}}return _90.fileSize;}catch(e){console.warn(e);return false;}}else{return false;}}},isFile:function(_91){_91=FileIO.normalizePath(_91);if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");return fso.FileExists(_91);}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _93=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);_93.initWithPath(_91);return _93.isFile();}catch(e){console.warn(e);return false;}}else{return false;}}},isDirectory:function(_94){_94=FileIO.normalizePath(_94);if(window.ActiveXObject){try{var fso=new ActiveXObject("Scripting.FileSystemObject");return fso.FolderExists(_94);}catch(e){console.warn(e);return false;}}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var _96=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);_96.initWithPath(_94);return _96.isDirectory();}catch(e){console.warn(e);return false;}}else{return false;}}}};